25984771
/home/gridsan/ddavid/ml/psets/ps6/significant.py:145: UserWarning: Dropping last batch of size 1 to avoid issues with batch normalization (dataset size = 1, batch_size = 64)
  warnings.warn(
/home/gridsan/ddavid/.conda/envs/torch/lib/python3.12/site-packages/lightning/pytorch/utilities/parsing.py:199: Attribute 'output_transform' is an instance of `nn.Module` and is already saved during checkpointing. It is recommended to ignore them using `self.save_hyperparameters(ignore=['output_transform'])`.
/home/gridsan/ddavid/.conda/envs/torch/lib/python3.12/site-packages/lightning/fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /home/gridsan/ddavid/ml/psets/ps6/significant.py 259 ...
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/gridsan/ddavid/.conda/envs/torch/lib/python3.12/site-packages/lightning/fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python /home/gridsan/ddavid/ml/psets/ps6/significant.py 259 ...
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [GPU-fa227a51-ef34-2c5f-7a25-50b4df14f8b6]
Loading `train_dataloader` to estimate number of stepping batches.
/home/gridsan/ddavid/.conda/envs/torch/lib/python3.12/site-packages/lightning/pytorch/loops/fit_loop.py:298: The number of training batches (46) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.

  | Name            | Type                         | Params
-----------------------------------------------------------------
0 | message_passing | MulticomponentMessagePassing | 455 K 
1 | agg             | MeanAggregation              | 0     
2 | bn              | BatchNorm1d                  | 1.2 K 
3 | predictor       | RegressionFFN                | 1.3 M 
4 | X_d_transform   | Identity                     | 0     
-----------------------------------------------------------------
1.7 M     Trainable params
0         Non-trainable params
1.7 M     Total params
6.877     Total estimated model params size (MB)
/home/gridsan/ddavid/.conda/envs/torch/lib/python3.12/site-packages/lightning/pytorch/utilities/data.py:104: Total length of `DataLoader` across ranks is zero. Please make sure this was your intention.
`Trainer.fit` stopped: `max_epochs=58` reached.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [GPU-fa227a51-ef34-2c5f-7a25-50b4df14f8b6]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 batch_averaged_test/mae    0.11325389891862869
 batch_averaged_test/r2     0.9883217811584473
batch_averaged_test/rmse    0.17860937118530273
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Traceback (most recent call last):
  File "/home/gridsan/ddavid/ml/psets/ps6/significant.py", line 273, in <module>
    kaggle_data = [data.MoleculeDatapoint.from_smi(smis[0], mfs=PropFeaturizer(solute_features)) for smis in smiss_kaggle]\
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gridsan/ddavid/.conda/envs/torch/lib/python3.12/site-packages/chemprop/data/datapoints.py", line 65, in from_smi
    return cls(mol, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 14, in __init__
  File "/home/gridsan/ddavid/.conda/envs/torch/lib/python3.12/site-packages/chemprop/data/datapoints.py", line 98, in __post_init__
    super().__post_init__(mfs)
  File "/home/gridsan/ddavid/.conda/envs/torch/lib/python3.12/site-packages/chemprop/data/datapoints.py", line 41, in __post_init__
    self.x_d = self.calc_features(mfs)
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/gridsan/ddavid/.conda/envs/torch/lib/python3.12/site-packages/chemprop/data/datapoints.py", line 107, in calc_features
    return np.hstack([mf(self.mol) for mf in mfs])
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: 'PropFeaturizer' object is not iterable
